docker-install 
=========

Установка docker / docker-compose и его зависимостей на новый сервер.

Переменные роли
------------

Описание и примеры переменных приведены в файле defaults/main.yml

Деплой
--------------

Для того чтобы развернуть docker на новом сервере необходимо:

Определить способ установки в переменой "docker_install_offline_mode".
Если это оффлайн режим, тогда скачать пакеты и указать путь к каталогу в переменой "docker_dist_name" и базову директорию "docker_dist_path"
Если это онлайн режим, тогда укаать пути к онлайн репозиторию и ключам в переменных в зависимости от версии пакетов:

RPM - пакеты:
docker_rpm_gpg_url
docker_rpm_repo_string

DEB - пакеты:
docker_deb_key_url
docker_deb_repo_string

Использование шаблонов
------------

Доступна возможность использования шаблонов.
Для того чтобы файл считался шаблоном, необходимо к его расширению добавить .j2,
например: docker-compose.yml -> docker-compose.yml.j2.
В процессе генерации конечных файлов, расширение .j2 будет отброшено.
В данной роли предсавлены следующие темплейты:

- 10sandbox.j2 - конфиг файл для apt-менеджера
- yum.conf.j2 - конфиг файл для yum-менеджера
- docker-online.repo.j2 - конфиг файл онлайн репозиториев
- docker-repository.list.j2 - конфиг файл оффлайн репозиториев
- docker.repo.j2 - конфиг файл удаленного репозиторея

Запуск
------------
Для запуска рекомендуется указывать версию интерпретатора python, установленного на target хосте:
ansible-playbook -i ~/hosts.txt ~/main.yml -vv --extra-vars 'ansible_python_interpreter=/usr/bin/python3.5'
